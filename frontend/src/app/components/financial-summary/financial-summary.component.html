<!-- financial-summary.component.html -->
<div class="min-h-screen bg-gray-50 p-4 md:p-6">
    <!-- Header Section -->
    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6">
      <div>
        <h1 class="text-2xl md:text-3xl font-bold text-gray-800">Financial Summary</h1>
        <p class="text-gray-600 mt-1">Track your income, expenses, and financial trends</p>
      </div>
      
      <div class="ml-auto flex items-center">
        <div class="flex flex-col sm:flex-row items-start sm:items-center gap-3">
          <span class="text-sm font-medium text-gray-700 whitespace-nowrap">Select Start Date:</span>
          <mat-form-field appearance="outline" class="w-full sm:w-48">
            <input matInput [matDatepicker]="startDatePicker" (dateChange)="onStartDateSelected($event)" [value]="startDate">
            <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #startDatePicker></mat-datepicker>
          </mat-form-field>
        </div>
        <div class="flex flex-col sm:flex-row items-start sm:items-center gap-3">
          <span class="text-sm font-medium text-gray-700 whitespace-nowrap">Select End Date:</span>
          <mat-form-field appearance="outline" class="w-full sm:w-48">
            <input matInput [matDatepicker]="endDatePicker" (dateChange)="onEndDateSelected($event)" [value]="endDate">
            <mat-datepicker-toggle matSuffix [for]="endDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #endDatePicker></mat-datepicker>
          </mat-form-field>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="flex flex-col items-center justify-center py-12">
      <mat-spinner diameter="40" class="mb-4"></mat-spinner>
      <p class="text-gray-600">Loading financial summary...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="!loading && error" class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
      <div class="flex items-center">
        <mat-icon class="text-red-500 mr-3">error_outline</mat-icon>
        <div>
          <p class="text-red-800 font-medium">Unable to load data</p>
          <p class="text-red-600 text-sm mt-1">{{ error }}</p>
        </div>
      </div>
    </div>

    <!-- Summary Cards -->
    <div *ngIf="!loading && summaryData" class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-6 md:mb-8">
      <!-- Income Card -->
      <mat-card class="summary-card bg-gradient-to-br from-green-50 to-green-100 border-l-4 border-green-500">
        <mat-card-content class="p-4">
          <div class="flex items-center mb-3">
            <div class="p-2 rounded-lg bg-green-500 bg-opacity-10 mr-3">
              <mat-icon class="text-green-600">trending_up</mat-icon>
            </div>
            <span class="text-gray-600 font-medium">Total Income</span>
          </div>
          <p class="text-2xl md:text-3xl font-bold text-gray-800">{{ summaryData.total_income | currency }}</p>
          <div class="flex items-center mt-2 text-sm text-green-600">
            <mat-icon class="text-sm mr-1">arrow_upward</mat-icon>
            <span>12% from last month</span>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Expenses Card -->
      <mat-card class="summary-card bg-gradient-to-br from-red-50 to-red-100 border-l-4 border-red-500">
        <mat-card-content class="p-4">
          <div class="flex items-center mb-3">
            <div class="p-2 rounded-lg bg-red-500 bg-opacity-10 mr-3">
              <mat-icon class="text-red-600">trending_down</mat-icon>
            </div>
            <span class="text-gray-600 font-medium">Total Expenses</span>
          </div>
          <p class="text-2xl md:text-3xl font-bold text-gray-800">{{ summaryData.total_expenses | currency }}</p>
          <div class="flex items-center mt-2 text-sm text-red-600">
            <mat-icon class="text-sm mr-1">arrow_downward</mat-icon>
            <span>8% from last month</span>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Balance Card -->
      <mat-card [class]="getBalanceCardClass()">
        <mat-card-content class="p-4">
          <div class="flex items-center mb-3">
            <div [class]="getBalanceIconClass()">
              <mat-icon>account_balance_wallet</mat-icon>
            </div>
            <span class="text-gray-600 font-medium">Balance</span>
          </div>
          <p [class]="getBalanceTextClass()">{{ (summaryData.total_income - summaryData.total_expenses) | currency }}</p>
          <div class="flex items-center mt-2 text-sm" [class]="getBalanceTrendClass()">
            <mat-icon class="text-sm mr-1">{{ getBalanceTrendIcon() }}</mat-icon>
            <span>{{ getBalanceTrendText() }}</span>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Charts Grid -->
    <div *ngIf="!loading && summaryData" class="grid grid-cols-1 xl:grid-cols-2 gap-4 md:gap-6">
      <!-- Income vs Expenses Chart -->
      <mat-card class="chart-card">
        <mat-card-header class="pb-3">
          <mat-card-title class="flex items-center text-lg font-semibold">
            <mat-icon class="mr-2 text-blue-600">bar_chart</mat-icon>
            Income vs Expenses
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div #incomeExpenseChart class="chart h-64 md:h-80"></div>
        </mat-card-content>
      </mat-card>

      <!-- Expense Categories Chart -->
      <mat-card class="chart-card">
        <mat-card-header class="pb-3">
          <mat-card-title class="flex items-center text-lg font-semibold">
            <mat-icon class="mr-2 text-purple-600">pie_chart</mat-icon>
            Expense Categories
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div #categoryChart class="chart h-64 md:h-80"></div>
        </mat-card-content>
      </mat-card>

      <!-- Financial Trend Chart -->
      <mat-card class="chart-card xl:col-span-2">
        <mat-card-header class="pb-3">
          <mat-card-title class="flex items-center text-lg font-semibold">
            <mat-icon class="mr-2 text-green-600">show_chart</mat-icon>
            Financial Trend (6 Months)
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div #trendChart class="chart h-64 md:h-80"></div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && !summaryData && !error" class="text-center py-12">
      <mat-icon class="text-gray-400 text-6xl mb-4">account_balance</mat-icon>
      <h3 class="text-xl font-semibold text-gray-700 mb-2">No Financial Data</h3>
      <p class="text-gray-500 mb-6">Select a different month or add transactions to see your financial summary.</p>
      <button mat-raised-button color="primary">
        <mat-icon class="mr-2">add</mat-icon>
        Add Transaction
      </button>
    </div>
</div>